<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{&quot;hostname&quot;:&quot;lxthyme.com&quot;,&quot;root&quot;:&quot;&#x2F;&quot;,&quot;images&quot;:&quot;&#x2F;images&quot;,&quot;scheme&quot;:&quot;Muse&quot;,&quot;version&quot;:&quot;8.5.0&quot;,&quot;exturl&quot;:false,&quot;sidebar&quot;:{&quot;position&quot;:&quot;left&quot;,&quot;display&quot;:&quot;post&quot;,&quot;padding&quot;:18,&quot;offset&quot;:12},&quot;copycode&quot;:true,&quot;bookmark&quot;:{&quot;enable&quot;:true,&quot;color&quot;:&quot;#222&quot;,&quot;save&quot;:&quot;auto&quot;},&quot;fancybox&quot;:true,&quot;mediumzoom&quot;:false,&quot;lazyload&quot;:true,&quot;pangu&quot;:false,&quot;comments&quot;:{&quot;style&quot;:&quot;tabs&quot;,&quot;active&quot;:null,&quot;storage&quot;:true,&quot;lazyload&quot;:false,&quot;nav&quot;:null},&quot;motion&quot;:{&quot;enable&quot;:true,&quot;async&quot;:false,&quot;transition&quot;:{&quot;post_block&quot;:&quot;fadeIn&quot;,&quot;post_header&quot;:&quot;fadeInDown&quot;,&quot;post_body&quot;:&quot;fadeInDown&quot;,&quot;coll_header&quot;:&quot;fadeInLeft&quot;,&quot;sidebar&quot;:&quot;fadeInUp&quot;}},&quot;prism&quot;:false,&quot;i18n&quot;:{&quot;placeholder&quot;:&quot;搜索...&quot;,&quot;empty&quot;:&quot;没有找到任何搜索结果：${query}&quot;,&quot;hits_time&quot;:&quot;找到 ${hits} 个搜索结果（用时 ${time} 毫秒）&quot;,&quot;hits&quot;:&quot;找到 ${hits} 个搜索结果&quot;}}</script><script src="/js/config.js"></script>
<meta name="description" content="网络七层协议(OSI模型) OSI(Open System Interconnect)，意为开放式系统互联。高层（即7、6、5、4层）定义了应用程序的功能下面3层（即3、2、1层）主要面向通过网络的端到端的数据流  IP协议: 对应于网络层TCP协议: 对应于传输层HTTP协议: 对应于应用层 HTTP的长连接和短连接本质上是TCP长连接和短连接。 HTTP属于应用层协议，在传输层使用TCP协议，">
<meta property="og:type" content="article">
<meta property="og:title" content="iOS -HTTP 相关">
<meta property="og:url" content="http://lxthyme.com/2018/01/08/iOS%20-HTTP%20%E7%9B%B8%E5%85%B3/index.html">
<meta property="og:site_name" content="lxthyme">
<meta property="og:description" content="网络七层协议(OSI模型) OSI(Open System Interconnect)，意为开放式系统互联。高层（即7、6、5、4层）定义了应用程序的功能下面3层（即3、2、1层）主要面向通过网络的端到端的数据流  IP协议: 对应于网络层TCP协议: 对应于传输层HTTP协议: 对应于应用层 HTTP的长连接和短连接本质上是TCP长连接和短连接。 HTTP属于应用层协议，在传输层使用TCP协议，">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://lxthyme.com/2018/01/08/iOS%20-HTTP%20%E7%9B%B8%E5%85%B3/9F291672B38EAD29EA489F9EBF905AE2.jpg">
<meta property="og:image" content="http://lxthyme.com/2018/01/08/iOS%20-HTTP%20%E7%9B%B8%E5%85%B3/D1492E69AB72F345425BE7C98511150A.jpg">
<meta property="og:image" content="http://lxthyme.com/2018/01/08/iOS%20-HTTP%20%E7%9B%B8%E5%85%B3/4E198F5C1E1E0AD4383FD5D261B64391.jpg">
<meta property="og:image" content="http://lxthyme.com/2018/01/08/iOS%20-HTTP%20%E7%9B%B8%E5%85%B3/038E99F6ED49858E712DDB6C69A2CD16.jpg">
<meta property="og:image" content="http://lxthyme.com/2018/01/08/iOS%20-HTTP%20%E7%9B%B8%E5%85%B3/BE86769BB49672D76B18076C9ABBDB7A.jpg">
<meta property="og:image" content="http://lxthyme.com/2018/01/08/iOS%20-HTTP%20%E7%9B%B8%E5%85%B3/92B7342566A93E352E43E3C27EAE672F.jpg">
<meta property="og:image" content="http://lxthyme.com/2018/01/08/iOS%20-HTTP%20%E7%9B%B8%E5%85%B3/949757CC8AD13633C72E27316886EB51.jpg">
<meta property="og:image" content="http://lxthyme.com/2018/01/08/iOS%20-HTTP%20%E7%9B%B8%E5%85%B3/D90D613F246590CF539DF0309F94A6C3.jpg">
<meta property="og:image" content="http://lxthyme.com/2018/01/08/iOS%20-HTTP%20%E7%9B%B8%E5%85%B3/7CA5BCC8241BB4A8C278B367D0B9513A.jpg">
<meta property="article:published_time" content="2018-01-08T02:51:55.000Z">
<meta property="article:modified_time" content="2018-03-08T07:17:32.000Z">
<meta property="article:author" content="lxthyme">
<meta property="article:tag" content="iOS Basic">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://lxthyme.com/2018/01/08/iOS%20-HTTP%20%E7%9B%B8%E5%85%B3/9F291672B38EAD29EA489F9EBF905AE2.jpg">


<link rel="canonical" href="http://lxthyme.com/2018/01/08/iOS%20-HTTP%20%E7%9B%B8%E5%85%B3/">



<script class="next-config" data-name="page" type="application/json">{&quot;sidebar&quot;:&quot;&quot;,&quot;isHome&quot;:false,&quot;isPost&quot;:true,&quot;lang&quot;:&quot;zh-CN&quot;,&quot;comments&quot;:true,&quot;permalink&quot;:&quot;http:&#x2F;&#x2F;lxthyme.com&#x2F;2018&#x2F;01&#x2F;08&#x2F;iOS%20-HTTP%20%E7%9B%B8%E5%85%B3&#x2F;&quot;,&quot;path&quot;:&quot;2018&#x2F;01&#x2F;08&#x2F;iOS -HTTP 相关&#x2F;&quot;,&quot;title&quot;:&quot;iOS -HTTP 相关&quot;}</script>

<script class="next-config" data-name="calendar" type="application/json">&quot;&quot;</script>
<title>iOS -HTTP 相关 | lxthyme</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">lxthyme</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>







</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E4%B8%83%E5%B1%82%E5%8D%8F%E8%AE%AE-OSI%E6%A8%A1%E5%9E%8B"><span class="nav-number">1.</span> <span class="nav-text">网络七层协议(OSI模型)</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%BA%94%E7%94%A8%E5%B1%82"><span class="nav-number">1.0.0.1.</span> <span class="nav-text">应用层</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%A1%A8%E7%A4%BA%E5%B1%82"><span class="nav-number">1.0.0.2.</span> <span class="nav-text">表示层</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BC%9A%E8%AF%9D%E5%B1%82"><span class="nav-number">1.0.0.3.</span> <span class="nav-text">会话层</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BC%A0%E8%BE%93%E5%B1%82"><span class="nav-number">1.0.0.4.</span> <span class="nav-text">传输层</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E5%B1%82"><span class="nav-number">1.0.0.5.</span> <span class="nav-text">网络层</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82"><span class="nav-number">1.0.0.6.</span> <span class="nav-text">数据链路层</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%89%A9%E7%90%86%E5%B1%82"><span class="nav-number">1.0.0.7.</span> <span class="nav-text">物理层</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%B1%82%E6%AC%A1%E5%88%92%E5%88%86%E5%8E%9F%E5%88%99"><span class="nav-number">1.0.0.8.</span> <span class="nav-text">层次划分原则</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%94%E5%B1%82%E6%A8%A1%E5%9E%8B"><span class="nav-number">2.</span> <span class="nav-text">五层模型</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%BA%94%E7%94%A8%E5%B1%82-1"><span class="nav-number">2.0.0.1.</span> <span class="nav-text">应用层</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BC%A0%E8%BE%93%E5%B1%82-1"><span class="nav-number">2.0.0.2.</span> <span class="nav-text">传输层</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E5%B1%82-1"><span class="nav-number">2.0.0.3.</span> <span class="nav-text">网络层</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82-1"><span class="nav-number">2.0.0.4.</span> <span class="nav-text">数据链路层</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%89%A9%E7%90%86%E5%B1%82-1"><span class="nav-number">2.0.0.5.</span> <span class="nav-text">物理层</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#TCP-UDP%E5%8D%8F%E8%AE%AE"><span class="nav-number">3.</span> <span class="nav-text">TCP&#x2F;UDP协议</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Socket"><span class="nav-number">4.</span> <span class="nav-text">Socket</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%AC%E5%9C%B0%E7%9A%84%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1%EF%BC%88IPC%EF%BC%89%E6%96%B9%E5%BC%8F"><span class="nav-number">4.0.1.</span> <span class="nav-text">本地的进程间通信（IPC）方式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E4%B8%AD%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1"><span class="nav-number">4.0.2.</span> <span class="nav-text">网络中进程间通信</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#TCP%E7%9A%84%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%BB%BA%E7%AB%8B%E8%BF%9E%E6%8E%A5"><span class="nav-number">4.0.3.</span> <span class="nav-text">TCP的三次握手建立连接</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#TCP%E7%9A%84%E5%9B%9B%E6%AC%A1%E6%8F%A1%E6%89%8B%E9%87%8A%E6%94%BE%E8%BF%9E%E6%8E%A5"><span class="nav-number">4.0.4.</span> <span class="nav-text">TCP的四次握手释放连接</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Socket-TCP-UDP-HTTP-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">4.0.5.</span> <span class="nav-text">Socket, TCP, UDP, HTTP 的区别</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SOCKET%E5%8E%9F%E7%90%86"><span class="nav-number">4.0.6.</span> <span class="nav-text">SOCKET原理</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%A5%97%E6%8E%A5%E5%AD%97%EF%BC%88socket%EF%BC%89%E6%A6%82%E5%BF%B5"><span class="nav-number">4.0.6.1.</span> <span class="nav-text">套接字（socket）概念</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%BB%BA%E7%AB%8Bsocket%E8%BF%9E%E6%8E%A5"><span class="nav-number">4.0.6.2.</span> <span class="nav-text">建立socket连接</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%E4%B8%AD-POST-%E5%92%8C-GET-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">4.0.7.</span> <span class="nav-text">网络请求中 POST 和 GET 的区别</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#HTTP1-0-1-1-2-0%E4%BB%A5%E5%8F%8AHTTPS"><span class="nav-number"></span> <span class="nav-text">HTTP1.0, 1.1, 2.0以及HTTPS</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTP1-0%E5%92%8C1-1%E7%8E%B0%E5%AD%98%E7%9A%84%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98"><span class="nav-number">0.1.</span> <span class="nav-text">HTTP1.0和1.1现存的一些问题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HTTPS"><span class="nav-number">1.</span> <span class="nav-text">HTTPS</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTPS%E4%B8%8EHTTP%E7%9A%84%E4%B8%80%E4%BA%9B%E5%8C%BA%E5%88%AB"><span class="nav-number">1.1.</span> <span class="nav-text">HTTPS与HTTP的一些区别</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTPS%E6%94%B9%E9%80%A0"><span class="nav-number">1.2.</span> <span class="nav-text">HTTPS改造</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SPDY"><span class="nav-number">2.</span> <span class="nav-text">SPDY</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HTTP2-0"><span class="nav-number">3.</span> <span class="nav-text">HTTP2.0</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTP2-0%E7%9A%84%E6%96%B0%E7%89%B9%E6%80%A7"><span class="nav-number">3.1.</span> <span class="nav-text">HTTP2.0的新特性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTP2-0%E7%9B%B8%E5%AF%B9HTTP1-1%E7%9A%84%E4%BC%98%E5%8A%BF"><span class="nav-number">3.2.</span> <span class="nav-text">HTTP2.0相对HTTP1.1的优势:</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%95%BF%E8%BF%9E%E6%8E%A5%E3%80%81%E7%9F%AD%E8%BF%9E%E6%8E%A5"><span class="nav-number">4.</span> <span class="nav-text">长连接、短连接</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#TCP%E8%BF%9E%E6%8E%A5%EF%BC%9A%E9%95%BF%E8%BF%9E%E6%8E%A5%E4%B8%8E%E7%9F%AD%E8%BF%9E%E6%8E%A5"><span class="nav-number">5.</span> <span class="nav-text">TCP连接：长连接与短连接</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BC%98%E7%82%B9"><span class="nav-number">5.1.</span> <span class="nav-text">优点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%BA%E7%82%B9"><span class="nav-number">5.2.</span> <span class="nav-text">缺点</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%95%BF%E8%BD%AE%E8%AF%A2%E5%92%8C%E7%9F%AD%E8%BD%AE%E8%AF%A2"><span class="nav-number">6.</span> <span class="nav-text">长轮询和短轮询</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Cookie-amp-Session-%E5%8C%BA%E5%88%AB"><span class="nav-number">7.</span> <span class="nav-text">Cookie &amp; Session 区别</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%99%84%E5%BD%95"><span class="nav-number">8.</span> <span class="nav-text">附录</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">lxthyme</p>
  <div class="site-description" itemprop="description">lxthyme's blog</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">23</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/lxthyme" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;lxthyme" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/lxthyme" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;lxthyme" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://instagram.com/lxthyme" title="Instagram → https:&#x2F;&#x2F;instagram.com&#x2F;lxthyme" rel="noopener" target="_blank"><i class="fab fa-instagram fa-fw"></i>Instagram</a>
      </span>
  </div>



        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/lxthyme" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://lxthyme.com/2018/01/08/iOS%20-HTTP%20%E7%9B%B8%E5%85%B3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="lxthyme">
      <meta itemprop="description" content="lxthyme's blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="lxthyme">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          iOS -HTTP 相关
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-01-08 10:51:55" itemprop="dateCreated datePublished" datetime="2018-01-08T10:51:55+08:00">2018-01-08</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2018-03-08 15:17:32" itemprop="dateModified" datetime="2018-03-08T15:17:32+08:00">2018-03-08</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h2 id="网络七层协议-OSI模型"><a href="#网络七层协议-OSI模型" class="headerlink" title="网络七层协议(OSI模型)"></a>网络七层协议(OSI模型)</h2><blockquote>
<p>OSI(Open System Interconnect)，意为开放式系统互联。<br>高层（即7、6、5、4层）定义了应用程序的功能<br>下面3层（即3、2、1层）主要面向通过网络的端到端的数据流</p>
</blockquote>
<p>IP协议: 对应于网络层<br>TCP协议: 对应于传输层<br>HTTP协议: 对应于应用层</p>
<p>HTTP的长连接和短连接<strong>本质上是TCP长连接和短连接</strong>。</p>
<p>HTTP属于应用层协议，在传输层使用TCP协议，在网络层使用IP协议。IP协议主要解决网络路由和寻址问题，TCP协议主要解决如何在IP层之上可靠的传递数据包，使在网络上的另一端收到发端发出的所有包，并且顺序与发出顺序一致。TCP有可靠，面向连接的特点。</p>
<p>HTTP协议是无状态的，指的是协议对于事务处理没有记忆能力，服务器不知道客户端是什么状态。</p>
<p>也就是说，打开一个服务器上的网页和你之前打开这个服务器上的网页之间没有任何联系。HTTP是一个无状态的面向连接的协议，无状态不代表HTTP不能保持TCP连接，更不能代表HTTP使用的是UDP协议（无连接）。</p>
<p>![IMAGE](<a target="_blank" rel="noopener" href="http://localhost:4000/2018/01/08/iOS">http://localhost:4000/2018/01/08/iOS</a> -HTTP 相关/D7B7618CFCF68973C9BB4D8C4487AEEF.jpg)</p>
<span id="more"></span>


<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">st=&gt;start: 应用层</span><br><span class="line"></span><br><span class="line">op1=&gt;operation: 表示层</span><br><span class="line">op2=&gt;operation: 会话层</span><br><span class="line">op3=&gt;operation: 传输层</span><br><span class="line">op4=&gt;operation: 网络层</span><br><span class="line">op5=&gt;operation: 数据链路层</span><br><span class="line"></span><br><span class="line">e=&gt;end: 物理层</span><br><span class="line"></span><br><span class="line">st-&gt;op1-&gt;op2-&gt;op3-&gt;op4-&gt;op5-&gt;e</span><br></pre></td></tr></table></figure>

<h5 id="应用层"><a href="#应用层" class="headerlink" title="应用层"></a>应用层</h5><blockquote>
<p>与其它计算机进行通讯的一个应用，它是对应应用程序的通信服务的.<br>文件传输，电子邮件，文件服务，虚拟终端</p>
</blockquote>
<ul>
<li>TELNET，HTTP，FTP，NFS，SMTP等</li>
</ul>
<h5 id="表示层"><a href="#表示层" class="headerlink" title="表示层"></a>表示层</h5><blockquote>
<p>定义数据格式及加密</p>
</blockquote>
<ul>
<li>加密，ASCII等</li>
</ul>
<h5 id="会话层"><a href="#会话层" class="headerlink" title="会话层"></a>会话层</h5><blockquote>
<p>定义了如何开始、控制和结束一个会话，包括对多个双向消息的控制和管理，以便在只完成连续消息的一部分时可以通知应用，从而使表示层看到的数据是连续的，在某些情况下，如果表示层收到了所有的数据，则用数据代表表示层。</p>
</blockquote>
<ul>
<li>RPC，SQL等。</li>
</ul>
<h5 id="传输层"><a href="#传输层" class="headerlink" title="传输层"></a>传输层</h5><blockquote>
<p>这层的功能包括是否选择差错恢复协议还是无差错恢复协议，及在同一主机上对不同应用的数据流的输入进行复用，还包括对收到的顺序不对的数据包的重新排序功能。</p>
</blockquote>
<ul>
<li>TCP，UDP，SPX。</li>
</ul>
<h5 id="网络层"><a href="#网络层" class="headerlink" title="网络层"></a>网络层</h5><blockquote>
<p>这层对端到端的包传输进行定义，它定义了能够标识所有结点的逻辑地址，还定义了路由实现的方式和学习的方式。为了适应最大传输单元长度小于包长度的传输介质，网络层还定义了如何将一个包分解成更小的包的分段方法。</p>
</blockquote>
<ul>
<li>IP，IPX等。</li>
</ul>
<h5 id="数据链路层"><a href="#数据链路层" class="headerlink" title="数据链路层"></a>数据链路层</h5><blockquote>
<p>定义了在单个链路上如何传输数据。这些协议与被讨论的各种介质有关。</p>
</blockquote>
<ul>
<li>ATM，FDDI等。</li>
</ul>
<h5 id="物理层"><a href="#物理层" class="headerlink" title="物理层"></a>物理层</h5><blockquote>
<p>OSI的物理层规范是有关传输介质的特性, 这些规范通常也参考了其他组织制定的标准。连接头、帧、帧的使用、电流、编码及光调制等都属于各种物理层规范中的内容。物理层常用多个规范完成对所有细节的定义。</p>
</blockquote>
<ul>
<li>Rj45，802.3等。</li>
</ul>
<h5 id="层次划分原则"><a href="#层次划分原则" class="headerlink" title="层次划分原则"></a>层次划分原则</h5><p><strong>OSI七层参考模型的各个层次的划分遵循下列原则:</strong></p>
<ol>
<li><p>同一层中的各网络节点都有相同的层次结构，具有同样的功能。</p>
</li>
<li><p>同一节点内相邻层之间通过接口(可以是逻辑接口)进行通信。</p>
</li>
<li><p>七层结构中的每一层使用下一层提供的服务，并且向其上层提供服务。</p>
</li>
<li><p>不同节点的同等层按照协议实现对等层之间的通信。</p>
</li>
</ol>
<h2 id="五层模型"><a href="#五层模型" class="headerlink" title="五层模型"></a>五层模型</h2><p><img data-src="9F291672B38EAD29EA489F9EBF905AE2.jpg" alt="IMAGE"></p>
<h5 id="应用层-1"><a href="#应用层-1" class="headerlink" title="应用层"></a>应用层</h5><blockquote>
</blockquote>
<h5 id="传输层-1"><a href="#传输层-1" class="headerlink" title="传输层"></a>传输层</h5><blockquote>
<p>四层交换机、也有工作在四层的路由器</p>
</blockquote>
<h5 id="网络层-1"><a href="#网络层-1" class="headerlink" title="网络层"></a>网络层</h5><blockquote>
<p>路由器、三层交换机</p>
</blockquote>
<h5 id="数据链路层-1"><a href="#数据链路层-1" class="headerlink" title="数据链路层"></a>数据链路层</h5><blockquote>
<p>网桥(现已很少使用)、以太网交换机(二层交换机)、网卡(其实网卡是一半工作在物理层、一半工作在数据链路层)</p>
</blockquote>
<h5 id="物理层-1"><a href="#物理层-1" class="headerlink" title="物理层"></a>物理层</h5><blockquote>
<p>中继器、集线器、还有我们通常说的双绞线也工作在物理层</p>
</blockquote>
<h2 id="TCP-UDP协议"><a href="#TCP-UDP协议" class="headerlink" title="TCP/UDP协议"></a>TCP/UDP协议</h2><p><strong>TCP</strong>: Transmission Control Protocol)<br><strong>UDP</strong>: User Datagram Protocol)</p>
<p>TCP 和 UDP 协议属于传输层协议。</p>
<p>TCP提供IP环境下的数据可靠传输，它提供的服务包括数据流传送、可靠性、有效流控、全双工操作和多路复 用。</p>
<p>通过面向连接、端到端和可靠的数据包发送。通俗说，它是事先为所发送的数据开辟出连接好的通道，然后再进行数据发送;</p>
<p>而UDP则不为IP提供可靠性、流控或差错恢复功能。</p>
<p>一般来说，TCP对应的是可靠性要求高的应用，而UDP对应的则是可靠性要求低、传输经济的应用。</p>
<p>TCP支持的应用协议主要 有：Telnet、FTP、SMTP等;</p>
<p>UDP支持的应用层协议主要有：NFS(网络文件系统)、SNMP(简单网络管理协议)、DNS(主域名称系 统)、TFTP(通用文件传输协议)等.</p>
<p>TCP/IP协议与低层的数据链路层和物理层无关，这也是TCP/IP的重要特点</p>
<h2 id="Socket"><a href="#Socket" class="headerlink" title="Socket"></a>Socket</h2><h4 id="本地的进程间通信（IPC）方式"><a href="#本地的进程间通信（IPC）方式" class="headerlink" title="本地的进程间通信（IPC）方式"></a>本地的进程间通信（IPC）方式</h4><ul>
<li>消息传递（管道、FIFO、消息队列）</li>
<li>同步（互斥量、条件变量、读写锁、文件和写记录锁、信号量）</li>
<li>共享内存（匿名的和具名的）</li>
<li>远程过程调用（Solaris门和Sun RPC）</li>
</ul>
<h4 id="网络中进程间通信"><a href="#网络中进程间通信" class="headerlink" title="网络中进程间通信"></a>网络中进程间通信</h4><p>网络层的<strong>ip地址</strong>可以唯一标识网络中的主机，而传输层的<strong>协议+端口</strong>可以唯一标识主机中的应用程序（进程）。这样利用三元组（<strong>ip地址</strong>，<strong>协议</strong>，<strong>端口</strong>）就可以标识网络的进程了，网络中的进程通信就可以利用这个标志与其它进程进行交互。</p>
<h4 id="TCP的三次握手建立连接"><a href="#TCP的三次握手建立连接" class="headerlink" title="TCP的三次握手建立连接"></a>TCP的三次握手建立连接</h4><p>Socket中TCP的三次握手建立连接, 大致流程如下:</p>
<ol>
<li>客户端向服务器发送一个SYN J</li>
<li>服务器向客户端响应一个SYN K，并对SYN J进行确认ACK J+1</li>
<li>客户端再想服务器发一个确认ACK K+1</li>
</ol>
<p><img data-src="D1492E69AB72F345425BE7C98511150A.jpg" alt="socket中发送的TCP三次握手"><br>从图中可以看出:</p>
<ol>
<li>当客户端调用connect时，触发了连接请求，向服务器发送了SYN J包，这时connect进入阻塞状态；</li>
<li>服务器监听到连接请求，即收到SYN J包，调用accept函数接收请求向客户端发送SYN K ，ACK J+1，这时accept进入阻塞状态；</li>
<li>客户端收到服务器的SYN K ，ACK J+1之后，这时connect返回，并对SYN K进行确认；服务器收到ACK </li>
<li>K+1时，accept返回，至此三次握手完毕，连接建立。</li>
</ol>
<p><strong>总结:</strong><br>客户端的connect在三次握手的第二个次返回，而服务器端的accept在三次握手的第三次返回。</p>
<h4 id="TCP的四次握手释放连接"><a href="#TCP的四次握手释放连接" class="headerlink" title="TCP的四次握手释放连接"></a>TCP的四次握手释放连接</h4><p>socket中TCP的四次握手释放连接的过程, 如下图:</p>
<p><img data-src="4E198F5C1E1E0AD4383FD5D261B64391.jpg" alt="socket中发送的TCP四次握手"></p>
<ol>
<li>某个应用进程首先调用close主动关闭连接，这时TCP发送一个<strong>FIN M</strong></li>
<li>另一端接收到FIN M之后，执行被动关闭，对这个FIN进行确认(<strong>ACK M+1</strong>)。它的接收也作为文件结束符传递给应用进程，因为FIN的接收意味着应用进程在相应的连接上再也接收不到额外数据；</li>
<li>一段时间之后，接收到文件结束符的应用进程调用close关闭它的socket。这导致它的TCP也发送一个<strong>FIN N</strong>.</li>
<li>接收到这个FIN的源发送端TCP对它进行确认(<strong>ACK N+1</strong>)。</li>
</ol>
<h4 id="Socket-TCP-UDP-HTTP-的区别"><a href="#Socket-TCP-UDP-HTTP-的区别" class="headerlink" title="Socket, TCP, UDP, HTTP 的区别"></a>Socket, TCP, UDP, HTTP 的区别</h4><p>Socket是对TCP/IP协议的封装，Socket本身并不是协议，而是一个调用接口（API），通过Socket，我们才能使用TCP/IP协议。</p>
<ul>
<li>http协议 对应于应用层</li>
<li>tcp协议 对应于传输层</li>
<li>ip协议 对应于网络层</li>
</ul>
<p>三者本质上没有可比性。 何况HTTP协议是基于TCP连接的。</p>
<p>TCP/IP是传输层协议，主要解决数据如何在网络中传输；<br>而HTTP是应用层协议，主要解决如何包装数据。</p>
<p>我们在传输数据时，可以只使用传输层（TCP/IP），但是那样的话，由于没有应用层，便无法识别数据内容，如果想要使传输的数据有意义，则必须使用应用层 协议，应用层协议很多，有HTTP、FTP、TELNET等等，也可以自己定义应用层协议。WEB使用HTTP作传输层协议，以封装HTTP文本信息，然 后使用TCP/IP做传输层协议将它发送到网络上。</p>
<h4 id="SOCKET原理"><a href="#SOCKET原理" class="headerlink" title="SOCKET原理"></a>SOCKET原理</h4><h5 id="套接字（socket）概念"><a href="#套接字（socket）概念" class="headerlink" title="套接字（socket）概念"></a>套接字（socket）概念</h5><p>套接字（socket）是通信的基石，是支持TCP/IP协议的网络通信的基本操作单元。它是网络通信过程中端点的抽象表示，包含进行网络通信必须的<strong>五种信息: ** <strong>连接使用的协议</strong>，</strong>本地主机的IP地址<strong>，</strong>本地进程的协议端口<strong>，</strong>远地主机的IP地址<strong>，</strong>远地进程的协议端口**。</p>
<p>应用层通过传输层进行数据通信时，TCP会遇到同时为多个应用程序进程提供并发服务的问题。多个TCP连接或多个应用程序进程可能需要通过同一个 TCP协议端口传输数据。为了区别不同的应用程序进程和连接，许多计算机操作系统为应用程序与TCP／IP协议交互提供了套接字(Socket)接口。应 用层可以和传输层通过Socket接口，区分来自不同应用程序进程或网络连接的通信，实现数据传输的并发服务。</p>
<h5 id="建立socket连接"><a href="#建立socket连接" class="headerlink" title="建立socket连接"></a>建立socket连接</h5><p>建立Socket连接至少需要一对套接字，其中一个运行于客户端，称为ClientSocket，另一个运行于服务器端，称为ServerSocket。</p>
<p>套接字之间的连接过程分为三个步骤：<strong>服务器监听</strong>，<strong>客户端请求</strong>，<strong>连接确认</strong>。</p>
<ol>
<li><p>服务器监听：服务器端套接字并不定位具体的客户端套接字，而是处于等待连接的状态，实时监控网络状态，等待客户端的连接请求。</p>
</li>
<li><p>客户端请求：指客户端的套接字提出连接请求，要连接的目标是服务器端的套接字。为此，客户端的套接字必须首先描述它要连接的服务器的套接字，指出服务器端套接字的地址和端口号，然后就向服务器端套接字提出连接请求。</p>
</li>
<li><p>连接确认：当服务器端套接字监听到或者说接收到客户端套接字的连接请求时，就响应客户端套接字的请求，建立一个新的线程，把服务器端套接字的描述发给客户 端，一旦客户端确认了此描述，双方就正式建立连接。而服务器端套接字继续处于监听状态，继续接收其他客户端套接字的连接请求。</p>
</li>
</ol>
<p>3、SOCKET连接与TCP连接</p>
<p>创建Socket连接时，可以指定使用的传输层协议，Socket可以支持不同的传输层协议（TCP或UDP），当使用TCP协议进行连接时，该Socket连接就是一个TCP连接。</p>
<p>4、Socket连接与HTTP连接</p>
<p>由于通常情况下Socket连接就是TCP连接，因此Socket连接一旦建立，通信双方即可开始相互发送数据内容，直到双方连接断开。但在实际网络应用 中，客户端到服务器之间的通信往往需要穿越多个中间节点，例如路由器、网关、防火墙等，大部分防火墙默认会关闭长时间处于非活跃状态的连接而导致 Socket 连接断连，因此需要通过<strong>轮询</strong>告诉网络，该连接处于活跃状态。</p>
<p>而HTTP连接使用的是“<strong>请求—响应</strong>”的方式，不仅在请求时需要先建立连接，而且需要客户端向服务器发出请求后，服务器端才能回复数据。</p>
<p>很多情况下，需要服务器端主动向客户端推送数据，保持客户端与服务器数据的实时与同步。此时若双方建立的是Socket连接，服务器就可以直接将数据传送给 客户端；若双方建立的是HTTP连接，则服务器需要等到客户端发送一次请求后才能将数据传回给客户端，因此，客户端定时向服务器端发送连接请求，不仅可以 保持在线，同时也是在“询问”服务器是否有新的数据，如果有就将数据传给客户端。</p>
<h4 id="网络请求中-POST-和-GET-的区别"><a href="#网络请求中-POST-和-GET-的区别" class="headerlink" title="网络请求中 POST 和 GET 的区别"></a>网络请求中 POST 和 GET 的区别</h4><p>GET是用于获取数据的，POST一般用于将数据发给服务器之用。</p>
<p>**普遍答案: **<br>1.GET使用URL或Cookie传参。而POST将数据放在BODY中。<br>2.GET的URL会有长度上的限制，则POST的数据则可以非常大。<br>3.POST比GET安全，因为数据在地址栏上不可见。</p>
<p><strong>GET</strong>的语义是请求获取指定的资源。GET方法是<strong>安全</strong>、<strong>幂等</strong>、<strong>可缓存</strong>的（除非有 Cache-ControlHeader的约束）,GET方法的报文主体没有任何语义。</p>
<p><strong>POST</strong>的语义是根据请求负荷（报文主体）对指定的资源做出处理，具体的处理方式视资源类型而不同。POST<strong>不安全</strong> <strong>不幂等</strong>，（大部分实现）<strong>不可缓存</strong>。为了针对其不可缓存性，有一系列的方法来进行优化，以后有机会再研究（FLAG已经立起）。</p>
<p><img data-src="038E99F6ED49858E712DDB6C69A2CD16.jpg" alt="IMAGE"></p>
<h1 id="HTTP1-0-1-1-2-0以及HTTPS"><a href="#HTTP1-0-1-1-2-0以及HTTPS" class="headerlink" title="HTTP1.0, 1.1, 2.0以及HTTPS"></a>HTTP1.0, 1.1, 2.0以及HTTPS</h1><p>影响一个HTTP网络请求的因素主要有两个：带宽和延迟。</p>
<p><strong>带宽:</strong> 如果说我们还停留在拨号上网的阶段，带宽可能会成为一个比较严重影响请求的问题，但是现在网络基础建设已经使得带宽得到极大的提升，我们不再会担心由带宽而影响网速，那么就只剩下延迟了。</p>
<p><strong>延迟:</strong></p>
<ol>
<li>浏览器阻塞（HOL blocking）：浏览器会因为一些原因阻塞请求。浏览器对于同一个域名，同时只能有 4 个连接（这个根据浏览器内核不同可能会有所差异），超过浏览器最大连接数限制，后续请求就会被阻塞。</li>
<li>DNS 查询（DNS Lookup）：浏览器需要知道目标服务器的 IP 才能建立连接。将域名解析为 IP 的这个系统就是 DNS。这个通常可以利用DNS缓存结果来达到减少这个时间的目的。</li>
<li>建立连接（Initial connection）：HTTP 是基于 TCP 协议的，浏览器最快也要在第三次握手时才能捎带 HTTP 请求报文，达到真正的建立连接，但是这些连接无法复用会导致每次请求都经历三次握手和慢启动。三次握手在高延迟的场景下影响较明显，慢启动则对文件类大请求影响较大。</li>
</ol>
<p><strong>主要区别主要体现在:</strong></p>
<ol>
<li><strong>缓存处理</strong>，在HTTP1.0中主要使用header里的If-Modified-Since,Expires来做为缓存判断的标准，HTTP1.1则引入了更多的缓存控制策略例如Entity tag，If-Unmodified-Since, If-Match, If-None-Match等更多可供选择的缓存头来控制缓存策略。</li>
<li><strong>带宽优化及网络连接的使用</strong>，HTTP1.0中，存在一些浪费带宽的现象，例如客户端只是需要某个对象的一部分，而服务器却将整个对象送过来了，并且不支持断点续传功能，HTTP1.1则在请求头引入了range头域，它允许只请求资源的某个部分，即返回码是206（Partial Content），这样就方便了开发者自由的选择以便于充分利用带宽和连接。</li>
<li><strong>错误通知的管理</strong>，在HTTP1.1中新增了24个错误状态响应码，如409（Conflict）表示请求的资源与资源的当前状态发生冲突；410（Gone）表示服务器上的某个资源被永久性的删除。</li>
<li><strong>Host头处理</strong>，在HTTP1.0中认为每台服务器都绑定一个唯一的IP地址，因此，请求消息中的URL并没有传递主机名（hostname）。但随着虚拟主机技术的发展，在一台物理服务器上可以存在多个虚拟主机（Multi-homed Web Servers），并且它们共享一个IP地址。HTTP1.1的请求消息和响应消息都应支持Host头域，且请求消息中如果没有Host头域会报告一个错误（400 Bad Request）。</li>
<li><strong>长连接</strong>，HTTP 1.1支持长连接（PersistentConnection）和请求的流水线（Pipelining）处理，在一个TCP连接上可以传送多个HTTP请求和响应，减少了建立和关闭连接的消耗和延迟，在HTTP1.1中默认开启Connection： keep-alive，一定程度上弥补了HTTP1.0每次请求都要创建连接的缺点。</li>
</ol>
<h3 id="HTTP1-0和1-1现存的一些问题"><a href="#HTTP1-0和1-1现存的一些问题" class="headerlink" title="HTTP1.0和1.1现存的一些问题"></a>HTTP1.0和1.1现存的一些问题</h3><ol>
<li>上面提到过的，HTTP1.x在传输数据时，每次都需要重新建立连接，无疑增加了大量的延迟时间，特别是在移动端更为突出。</li>
<li>HTTP1.x在传输数据时，所有传输的内容都是明文，客户端和服务器端都无法验证对方的身份，这在一定程度上无法保证数据的安全性。</li>
<li>HTTP1.x在使用时，header里携带的内容过大，在一定程度上增加了传输的成本，并且每次请求header基本不怎么变化，尤其在移动端增加用户流量。</li>
<li>虽然HTTP1.x支持了keep-alive，来弥补多次创建连接产生的延迟，但是keep-alive使用多了同样会给服务端带来大量的性能压力，并且对于单个文件被不断请求的服务(例如图片存放网站)，keep-alive可能会极大的影响性能，因为它在文件被请求之后还保持了不必要的连接很长时间。</li>
</ol>
<h2 id="HTTPS"><a href="#HTTPS" class="headerlink" title="HTTPS"></a>HTTPS</h2><h3 id="HTTPS与HTTP的一些区别"><a href="#HTTPS与HTTP的一些区别" class="headerlink" title="HTTPS与HTTP的一些区别"></a>HTTPS与HTTP的一些区别</h3><blockquote>
<p>需要申请证书, 加密, 端口不同(80, 443), 防劫持</p>
</blockquote>
<ol>
<li>HTTPS协议需要到CA申请证书，一般免费证书很少，需要交费。</li>
<li>HTTP协议运行在TCP之上，所有传输的内容都是明文，HTTPS运行在SSL/TLS之上，SSL/TLS运行在TCP之上，所有传输的内容都经过加密的。</li>
<li>HTTP和HTTPS使用的是完全不同的连接方式，用的端口也不一样，前者是80，后者是443。</li>
<li>HTTPS可以有效的防止运营商劫持，解决了防劫持的一个大问题。</li>
</ol>
<h3 id="HTTPS改造"><a href="#HTTPS改造" class="headerlink" title="HTTPS改造"></a>HTTPS改造</h3><p>如果一个网站要全站由HTTP替换成HTTPS，可能需要关注以下几点：</p>
<ol>
<li>安装CA证书，一般的证书都是需要收费的，这边推荐一个比较好的购买证书网站：1) Let’s Encrypt，免费，快捷，支持多域名（不是通配符），三条命令即时签署+导出证书。缺点是暂时只有三个月有效期，到期需续签。2) Comodo PositiveSSL，收费，但是比较稳定。</li>
<li>在购买证书之后，在证书提供的网站上配置自己的域名，将证书下载下来之后，配置自己的web服务器，同时进行代码改造。</li>
<li>HTTPS 降低用户访问速度。SSL握手，HTTPS 对速度会有一定程度的降低，但是只要经过合理优化和部署，HTTPS 对速度的影响完全可以接受。在很多场景下，HTTPS 速度完全不逊于 HTTP，如果使用 SPDY，HTTPS 的速度甚至还要比 HTTP 快。</li>
<li>相对于HTTPS降低访问速度，其实更需要关心的是服务器端的CPU压力，HTTPS中大量的密钥算法计算，会消耗大量的CPU资源，只有足够的优化，HTTPS 的机器成本才不会明显增加。</li>
</ol>
<h2 id="SPDY"><a href="#SPDY" class="headerlink" title="SPDY"></a>SPDY</h2><p>SPDY可以说是综合了HTTPS和HTTP两者有点于一体的传输协议，主要解决：</p>
<ol>
<li><strong>降低延迟</strong>，针对HTTP高延迟的问题，SPDY优雅的采取了<strong>多路复用</strong>（multiplexing）。多路复用通过多个请求stream共享一个tcp连接的方式，解决了HOL blocking的问题，降低了延迟同时提高了带宽的利用率。</li>
<li><strong>请求优先级</strong>（request prioritization）。多路复用带来一个新的问题是，在连接共享的基础之上有可能会导致关键请求被阻塞。SPDY允许给每个request设置优先级，这样重要的请求就会优先得到响应。比如浏览器加载首页，首页的html内容应该优先展示，之后才是各种静态资源文件，脚本文件等加载，这样可以保证用户能第一时间看到网页内容。</li>
<li><strong>header压缩</strong>。前面提到HTTP1.x的header很多时候都是重复多余的。选择合适的压缩算法可以减小包的大小和数量。</li>
<li>基于HTTPS的加密协议传输，大大<strong>提高了传输数据的可靠性</strong>。</li>
<li><strong>服务端推送</strong>（server push），采用了SPDY的网页，例如我的网页有一个sytle.css的请求，在客户端收到sytle.css数据的同时，服务端会将sytle.js的文件推送给客户端，当客户端再次尝试获取sytle.js时就可以直接从缓存中获取到，不用再发请求了。SPDY构成图：<br> <img data-src="BE86769BB49672D76B18076C9ABBDB7A.jpg" alt="IMAGE"><br> SPDY位于HTTP之下，TCP和SSL之上，这样可以轻松<strong>兼容老版本</strong>的HTTP协议(将HTTP1.x的内容封装成一种新的frame格式)，同时可以使用已有的SSL功能。</li>
</ol>
<h2 id="HTTP2-0"><a href="#HTTP2-0" class="headerlink" title="HTTP2.0"></a>HTTP2.0</h2><blockquote>
<p>HTTP2.0可以说是SPDY的升级版（其实原本也是基于SPDY设计的），但是，HTTP2.0 跟 SPDY 仍有不同的地方，主要是以下两点：<br>HTTP2.0 支持明文 HTTP 传输，而 SPDY 强制使用 HTTPS<br>HTTP2.0 消息头的压缩算法采用 HPACK，而非 SPDY 采用的 DEFLATE</p>
</blockquote>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/lizheng114/p/6543809.html?utm_source=tuicool&utm_medium=referral">iOS性能之HTTP2.0</a></p>
</blockquote>
<h3 id="HTTP2-0的新特性"><a href="#HTTP2-0的新特性" class="headerlink" title="HTTP2.0的新特性"></a>HTTP2.0的新特性</h3><ol>
<li><p><strong>新的二进制格式</strong>（Binary Format）<br> HTTP1.x的解析是基于文本。基于文本协议的格式解析存在天然缺陷，文本的表现形式有多样性，要做到健壮性考虑的场景必然很多，二进制则不同，只认0和1的组合。基于这种考虑HTTP2.0的协议解析决定采用二进制格式，实现方便且健壮。</p>
</li>
<li><p><strong>多路复用</strong>（MultiPlexing）<br> 即连接共享，即每一个request都是是用作连接共享机制的。一个request对应一个id，这样一个连接上可以有多个request，每个连接的request可以随机的混杂在一起，接收方可以根据request的 id将request再归属到各自不同的服务端请求里面。多路复用原理图：<br> <img data-src="92B7342566A93E352E43E3C27EAE672F.jpg" alt="IMAGE"></p>
</li>
<li><p><strong>header压缩</strong><br> 如上文中所言，对前面提到过HTTP1.x的header带有大量信息，而且每次都要重复发送，HTTP2.0使用encoder来减少需要传输的header大小，通讯双方各自cache一份header fields表，既避免了重复header的传输，又减小了需要传输的大小。</p>
</li>
<li><p><strong>服务端推送</strong>（server push）</p>
</li>
</ol>
<p><strong>关于HTTP2和HTTP1.x的区别大致可以看下图</strong><br><img data-src="949757CC8AD13633C72E27316886EB51.jpg" alt="IMAGE"></p>
<h3 id="HTTP2-0相对HTTP1-1的优势"><a href="#HTTP2-0相对HTTP1-1的优势" class="headerlink" title="HTTP2.0相对HTTP1.1的优势:"></a>HTTP2.0相对HTTP1.1的优势:</h3><ol>
<li>相同的Host占用一个TCP链接</li>
<li>请求可以设置优先级</li>
<li>采用二进制协议，而不是之前的文本协议</li>
<li>多路复用</li>
<li>头部压缩</li>
</ol>
<p>这几点优势里面，我个人认为最为重要的，就是多路复用和头部压缩，正是这两项优势，让请求的性能得到了极大的提升。</p>
<p>TCP在建立链接的过程中，需要经过三次握手， HTTP协议是建立在TCP协议之上的，不过HTTP是短链接，一旦请求结束，链接要被释放，但是为了提升服务端于客户端之间请求的效率（减少TCP建立链接的性能损耗），所以虽然HTTP链接被释放了，但是底层TCP链接还在（可以用wireshark抓包看看）。</p>
<p>但是TCP链接也不是无限多，iOS的NSURLSession是分配的4个TCP链接，MAC是6个。</p>
<h2 id="长连接、短连接"><a href="#长连接、短连接" class="headerlink" title="长连接、短连接"></a>长连接、短连接</h2><p>在HTTP/1.0中，默认使用的是短连接。</p>
<p>也就是说，浏览器和服务器每进行一次HTTP操作，就建立一次连接，但任务结束就中断连接。如果客户端浏览器访问的某个HTML或其他类型的 Web页中包含有其他的Web资源，如JavaScript文件、图像文件、CSS文件等；当浏览器每遇到这样一个Web资源，就会建立一个HTTP会话。</p>
<p>但从 HTTP/1.1起，默认使用长连接，用以保持连接特性。使用长连接的HTTP协议，会在响应头有加入这行代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Connection:keep-alive</span><br></pre></td></tr></table></figure>
<p>在使用长连接的情况下，当一个网页打开完成后，客户端和服务器之间用于传输HTTP数据的 TCP连接不会关闭，如果客户端再次访问这个服务器上的网页，会继续使用这一条已经建立的连接。Keep-Alive不会永久保持连接，它有一个保持时间，可以在不同的服务器软件（如Apache）中设定这个时间。实现长连接要客户端和服务端都支持长连接。</p>
<p>再次重申：<strong>HTTP协议的长连接和短连接，实质上是TCP协议的长连接和短连接。</strong></p>
<h2 id="TCP连接：长连接与短连接"><a href="#TCP连接：长连接与短连接" class="headerlink" title="TCP连接：长连接与短连接"></a>TCP连接：长连接与短连接</h2><p>当网络通信时采用TCP协议时，在真正的读写操作之前，server与client之间必须建立一个连接，当读写操作完成后，双方不再需要这个连接 时它们可以释放这个连接，连接的建立是需要三次握手的，而释放则需要4次握手，所以说每个连接的建立都是需要资源消耗和时间消耗的.<br>经典的三次握手示意图：<br><img data-src="D90D613F246590CF539DF0309F94A6C3.jpg" alt="IMAGE"><br>经典的四次握手关闭图：<br><img data-src="7CA5BCC8241BB4A8C278B367D0B9513A.jpg" alt="IMAGE"></p>
<h3 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h3><p>短连接: 管理起来比较简单，存在的连接都是有用的连接，不需要额外的控制手段<br>长连接: 可以省去较多的TCP建立和关闭的操作，减少浪费，节约时间。对于频繁请求资源的客户来说，较适用长连接</p>
<h3 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h3><p>短连接:</p>
<ol>
<li>短连接对于服务器来说管理较为简单，存在的连接都是有用的连接，不需要额外的控制手段。但如果客户请求频繁，将在TCP的建立和关闭操作上浪费时间和带宽。</li>
</ol>
<p>长连接:</p>
<ol>
<li><p>长连接多用于操作频繁，点对点的通讯，而且连接数不能太多的情况。例如：数据库的连接用长连接，如果用短连接频繁的通信会造成socket错误，而且频繁的socket 创建也是对资源的浪费. 而像WEB网站的http服务一般都用短链接。因为长连接对于服务端来说会耗费一定的资源，而像WEB网站这么频繁的成千上万甚至上亿客户端的连接用短连接会更省一些资源，如果用长连接，而且同时有成千上万的用户，如果每个用户都占用一个连接的话，那可想而知吧。所以并发量大，但每个用户无需频繁操作情况下需用短连好。</p>
</li>
<li><p>存活功能的探测周期太长，还有就是它只是探测TCP连接的存活，属于比较斯文的做法，遇到恶意的连接时，保活功能就不够使了。</p>
</li>
<li><p>在长连接的应用场景下，client端一般不会主动关闭它们之间的连接，Client与server之间的连接如果一直不关闭的话，会存在一个问题: 随着客户端连接越来越多，server早晚有扛不住的时候，这时候server端需要采取一些策略，如关闭一些长时间没有读写事件发生的连接，这样可 以避免一些恶意连接导致server端服务受损；如果条件再允许就可以以客户端机器为颗粒度，限制每个客户端的最大长连接数，这样可以完全避免某个蛋疼的客户端连累后端服务。</p>
</li>
</ol>
<p>短连接的操作步骤是：</p>
<ul>
<li>建立连接——数据传输——关闭连接…建立连接——数据传输——关闭连接</li>
</ul>
<p>长连接的操作步骤是：</p>
<ul>
<li>建立连接——数据传输…（保持连接）…数据传输——关闭连接</li>
</ul>
<h2 id="长轮询和短轮询"><a href="#长轮询和短轮询" class="headerlink" title="长轮询和短轮询"></a>长轮询和短轮询</h2><p>长轮询和短轮询最大的区别是，短轮询去服务端查询的时候，不管库存量有没有变化，服务器就立即返回结果了。而长轮询则不是，在长轮询中，服务器如果检测到库存量没有变化的话，将会把当前请求挂起一段时间（这个时间也叫作超时时间，一般是几十秒）。在这个时间里，服务器会去检测库存量有没有变化，检测到变化就立即返回，否则就一直等到超时为止。</p>
<p>而对于客户端来说，不管是长轮询还是短轮询，客户端的动作都是一样的，就是不停的去请求，不同的是服务端，短轮询情况下服务端每次请求不管有没有变化都会立即返回结果，而长轮询情况下，如果有变化才会立即返回结果，而没有变化的话，则不会再立即给客户端返回结果，直到超时为止。</p>
<p>但是长轮询也是有坏处的，因为把请求挂起同样会导致资源的浪费，假设还是1000个人停留在某个商品详情页面，那就很有可能服务器这边挂着1000个线程，在不停检测库存量，这依然是有问题的。</p>
<p>因此，从这里可以看出，不管是长轮询还是短轮询，都不太适用于客户端数量太多的情况，因为每个服务器所能承载的TCP连接数是有上限的，这种轮询很容易把连接数顶满。</p>
<h2 id="Cookie-amp-Session-区别"><a href="#Cookie-amp-Session-区别" class="headerlink" title="Cookie &amp; Session 区别"></a>Cookie &amp; Session 区别</h2><p>Cookie与Session都能够进行会话跟踪，但是完成的原理不太一样。普通状况下二者均能够满足需求，但有时分不能够运用Cookie，有时分不能够运用Session。下面经过比拟阐明二者的特性以及适用的场所。</p>
<ol>
<li>客户端标识方法不同</li>
<li>存取方式的不同</li>
<li>隐私策略的不同</li>
<li>有效期上的不同</li>
<li>服务器压力的不同</li>
<li>浏览器支持的不同</li>
<li>跨域支持上的不同</li>
</ol>
<h2 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h2><ol>
<li><a target="_blank" rel="noopener" href="http://m.mamicode.com/info-detail-1199706.html">HTTP2.0那些事</a></li>
<li><a target="_blank" rel="noopener" href="http://blog.csdn.net/summy_J/article/details/76578239">HTTP1.0,HTTP1.1,HTTP2.0,SPDY,HTTPS你应该知道的一些事</a></li>
<li><a target="_blank" rel="noopener" href="http://blog.csdn.net/summy_J/article/details/74857767">图解TCP—3次握手&amp;4次挥手</a></li>
<li><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzAxODE2MjM1MA==&mid=2651550770&idx=1&sn=2d91b570bda9615afe3db5997723ff43&mpshare=1&scene=23&srcid=0714TMMZArc3b2eqki8Dvq3d#rd">谈谈HTTP协议中的短轮询、长轮询、长连接和短连接</a></li>
<li><a target="_blank" rel="noopener" href="http://blog.csdn.net/summy_j/article/details/76579751"> Cookie与Session的区别</a></li>
</ol>

    </div>

    
    
    
      
  <div class="popular-posts-header">相关文章</div>
  <ul class="popular-posts">
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/2017/12/25/URL Scheme/" rel="bookmark">URL Scheme</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/2018/01/08/iOS - Run Loop/" rel="bookmark">iOS - Run Loop</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/2017/12/27/iOS - 动画篇/" rel="bookmark">iOS - 动画篇</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/2018/01/08/iOS - 推送/" rel="bookmark">iOS - 推送</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/2017/12/26/iOS - 演变『简略』/" rel="bookmark">iOS - 演变『简略』</a></div>
    </li>
  </ul>


    <footer class="post-footer">
          <div class="reward-container">
  <div></div>
  <button onclick="document.querySelector('.post-reward').classList.toggle('active');">
    赞赏
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/wechatpay.png" alt="lxthyme 微信">
        <span>微信</span>
      </div>
      <div>
        <img src="/images/alipay.png" alt="lxthyme 支付宝">
        <span>支付宝</span>
      </div>

  </div>
</div>

          <div class="followme">
  <span>欢迎关注我的其它发布渠道</span>

  <div class="social-list">

      <div class="social-item">
        <a target="_blank" class="social-link" href="https://twitter.com/lxthyme">
          <span class="icon">
            <i class="fab fa-twitter"></i>
          </span>

          <span class="label">Twitter</span>
        </a>
      </div>

      <div class="social-item">
        <a target="_blank" class="social-link" href="/atom.xml">
          <span class="icon">
            <i class="fa fa-rss"></i>
          </span>

          <span class="label">RSS</span>
        </a>
      </div>
  </div>
</div>

          <div class="post-tags">
              <a href="/tags/ios-basic/" rel="tag"># iOS Basic</a>
          </div>

        
  <div class="post-widgets">
    <div class="wp_rating">
      <div id="wpac-rating"></div>
    </div>
  </div>

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2018/01/08/iOS%20-%20Q/" rel="prev" title="iOS - Q">
                  <i class="fa fa-chevron-left"></i> iOS - Q
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2018/01/08/LateX/" rel="next" title="LateX">
                  LateX <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">lxthyme</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/lozad@1.16.0/dist/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>

  
  <script src="https://embed.widgetpack.com/widget.js" async></script>
  <script class="next-config" data-name="rating" type="application/json">{&quot;enable&quot;:true,&quot;id&quot;:null,&quot;color&quot;:&quot;#fc6423&quot;}</script>
  <script src="/js/third-party/rating.js"></script>






  





</body>
</html>
